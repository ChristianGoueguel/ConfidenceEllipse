<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Confidence Ellipse Coordinates — confidence_ellipse • ConfidenceEllipse</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Confidence Ellipse Coordinates — confidence_ellipse"><meta name="description" content="Compute the coordinate points of confidence ellipses at a specified confidence level."><meta property="og:description" content="Compute the coordinate points of confidence ellipses at a specified confidence level."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ConfidenceEllipse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/confidence-ellipse.html">Confidence Ellipse</a></li>
    <li><a class="dropdown-item" href="../articles/confidence-ellipsoid.html">Confidence Ellipsoid</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ChristianGoueguel/ConfidenceEllipse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Confidence Ellipse Coordinates</h1>
      <small class="dont-index">Source: <a href="https://github.com/ChristianGoueguel/ConfidenceEllipse/blob/main/R/confidence_ellipse.R" class="external-link"><code>R/confidence_ellipse.R</code></a></small>
      <div class="d-none name"><code>confidence_ellipse.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute the coordinate points of confidence ellipses at a specified confidence level.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">confidence_ellipse</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  .group_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"normal"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>data frame or tibble.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>column name for the x-axis variable.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>column name for the y-axis variable.</p></dd>


<dt id="arg--group-by">.group_by<a class="anchor" aria-label="anchor" href="#arg--group-by"></a></dt>
<dd><p>column name for the grouping variable (<code>NULL</code> by default).
Note that this grouping variable must be a factor.</p></dd>


<dt id="arg-conf-level">conf_level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>confidence level for the ellipse (0.95 by default).</p></dd>


<dt id="arg-robust">robust<a class="anchor" aria-label="anchor" href="#arg-robust"></a></dt>
<dd><p>optional (<code>FALSE</code> by default). When set to <code>TRUE</code>, it indicates
that robust estimation method is employed to calculate the coordinates of the ellipse.
The location is estimated using a 1-step M-estimator with the biweight psi function,
while the scale is estimated using the Minimum Covariance Determinant (MCD) estimator.
This approach is more resistant to outliers and provides
more reliable ellipse boundaries when the data contains extreme values or follows
a non-normal distribution.</p></dd>


<dt id="arg-distribution">distribution<a class="anchor" aria-label="anchor" href="#arg-distribution"></a></dt>
<dd><p>optional (<code>"normal"</code> by default). The distribution used to
calculate the quantile for the ellipse. It can be either <code>"normal"</code> or <code>"hotelling"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Data frame of the coordinates points.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function computes the coordinates of the confidence ellipse based
on the specified confidence level and the provided data. It can handle both classical
and robust estimation methods, and it supports grouping by a factor variable.
The <code>distribution</code> parameter controls the statistical approach used for ellipse
calculation. The <code>"normal"</code> option uses the chi-square distribution quantile,
which is appropriate when working with very large samples.
Whereas the <code>"hotelling"</code> option uses Hotelling's T² distribution quantile.
This approach accounts for uncertainty in estimating both mean and covariance
from sample data, producing larger ellipses that better reflect sampling uncertainty.
This is statistically more rigorous for smaller sample sizes where parameter
estimation uncertainty is higher.</p>
<p>The combination of <code>distribution = "hotelling"</code> and <code>robust = TRUE</code> offers the
most conservative and statistically rigorous approach, particularly recommended
for exploratory data analysis and when dealing with real-world datasets that may
not meet ideal statistical assumptions. For very large samples, the default
settings (<code>distribution = "normal"</code>, <code>robust = FALSE</code>) may be sufficient, as
the differences between methods diminish with increasing sample size.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Raymaekers, J., Rousseeuw P.J. (2019). Fast robust correlation for high dimensional data. Technometrics, 63(2), 184-198.</p></li>
<li><p>Brereton, R. G. (2016). Hotelling’s T-squared distribution, its relationship to the F distribution and its use in multivariate space. Journal of Chemometrics, 30(1), 18–21.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Christian L. Goueguel</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"glass"</span>, package <span class="op">=</span> <span class="st">"ConfidenceEllipse"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Confidence ellipse</span></span></span>
<span class="r-in"><span><span class="va">ellipse</span> <span class="op">&lt;-</span> <span class="fu">confidence_ellipse</span><span class="op">(</span>.data <span class="op">=</span> <span class="va">glass</span>, x <span class="op">=</span> <span class="va">SiO2</span>, y <span class="op">=</span> <span class="va">Na2O</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ellipse_grp</span> <span class="op">&lt;-</span> <span class="fu">confidence_ellipse</span><span class="op">(</span></span></span>
<span class="r-in"><span>.data <span class="op">=</span> <span class="va">glass</span>,</span></span>
<span class="r-in"><span>x <span class="op">=</span> <span class="va">SiO2</span>,</span></span>
<span class="r-in"><span>y <span class="op">=</span> <span class="va">Na2O</span>,</span></span>
<span class="r-in"><span>.group_by <span class="op">=</span> <span class="va">glassType</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christian L. Goueguel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

