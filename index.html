<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="This package provided a function to calculate confidence ellipse, based on the assumption of bivariate normality, for a given confidence level.">
<title>Confidence Ellipse Coordinates for Bivariate Normal Data • ConfidenceEllipse</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Confidence Ellipse Coordinates for Bivariate Normal Data">
<meta property="og:description" content="This package provided a function to calculate confidence ellipse, based on the assumption of bivariate normality, for a given confidence level.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">ConfidenceEllipse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="confidenceellipse">ConfidenceEllipse<a class="anchor" aria-label="anchor" href="#confidenceellipse"></a>
</h1>
</div>
<p><img src="reference/figures/logo.png" align="right" height="239" alt=""></p>
<!-- badges: start -->

<p>The objective of the <code>ConfidenceEllipse</code> package is to compute the confidence ellipse for a given bivariate normal data. The size of the ellipse is determined by the confidence level, and the shape is determined by the correlation structure between the variables. The confidence level is usually chosen to be 95% or 99%, and the resulting ellipse contains the points that are expected to lie within the multivariate distribution.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>ConfidenceEllipse</code> like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="co"># remotes::install_github("ChristianGoueguel/ConfidenceEllipse")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="section level3">
<h3 id="dataset">Dataset<a class="anchor" aria-label="anchor" href="#dataset"></a>
</h3>
<p>The dataset is comprised of 13 different measurements for 180 archaeological glass vessels from different groups (Janssen, K.H.A., De Raedt, I., Schalm, O., Veeckman, J.: Microchim. Acta 15 (suppl.) (1998) 253-267. Compositions of 15th - 17th century archaeological glass vessels excavated in Antwerp.)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">glass</span>, package <span class="op">=</span> <span class="st">"chemometrics"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">glass.grp</span>, package <span class="op">=</span> <span class="st">"chemometrics"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">glass.grp</span>, <span class="va">glass</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>glassType <span class="op">=</span> <span class="va">glass.grp</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">modify_at</span><span class="op">(</span><span class="st">"glassType"</span>, <span class="va">as_factor</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 180 × 14</span></span>
<span><span class="co">#&gt;    glassType  Na2O   MgO Al2O3  SiO2  P2O5   SO3    Cl   K2O   CaO   MnO Fe2O3</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 1          13.9  2.24  1.31  67.8 0.884 0.052 0.936  3.04  8.78 0.674 0.364</span></span>
<span><span class="co">#&gt;  2 1          14.2  2.18  1.31  67.1 0.938 0.024 0.966  3.40  8.64 0.698 0.336</span></span>
<span><span class="co">#&gt;  3 1          14.7  3.03  1.36  63.3 0.988 0.064 0.886  2.83 11.1  1.24  0.4  </span></span>
<span><span class="co">#&gt;  4 1          14.8  2.46  1.38  63.8 1.2   0.115 0.988  2.88 10.8  0.978 0.433</span></span>
<span><span class="co">#&gt;  5 1          14.1  2.48  1.07  68.8 0.682 0.07  0.966  2.40  8.81 0.31  0.242</span></span>
<span><span class="co">#&gt;  6 1          13.6  1.65  2.01  69.6 0.698 0.038 0.908  3.20  6.16 1.17  0.65 </span></span>
<span><span class="co">#&gt;  7 1          12.9  2.69  1.42  64.0 0.966 0.046 0.896  2.53 13.0  0.874 0.516</span></span>
<span><span class="co">#&gt;  8 1          15.7  2.03  1.24  70.6 0.21  0.31  0.676  2.33  6.32 0.214 0.278</span></span>
<span><span class="co">#&gt;  9 1          13.9  2.26  1.07  68.3 0.75  0.037 0.935  2.32  9.44 0.605 0.25 </span></span>
<span><span class="co">#&gt; 10 1          17.2  1.47  1.66  66.0 0.838 0.096 1.06   3.42  6.36 1.29  0.5  </span></span>
<span><span class="co">#&gt; # ℹ 170 more rows</span></span>
<span><span class="co">#&gt; # ℹ 2 more variables: BaO &lt;dbl&gt;, PbO &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="confidence-ellipse">Confidence Ellipse<a class="anchor" aria-label="anchor" href="#confidence-ellipse"></a>
</h3>
<p>First, the <code>confidence_ellipse</code> function is used to compute coordinate points of the confidence ellipse and then the ellipse is plotted on a two-dimensional plot <code>x</code> and <code>y</code> of the data. Points that lie outside the ellipse are considered to be outliers, while points that lie within the ellipse are considered to be part of the underlying distribution with the specified confidence level <code>conf_level</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot1</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">MgO</span>, y <span class="op">=</span> <span class="va">Cl</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylim</span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>, <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"MgO (wt.%)"</span>, y <span class="op">=</span> <span class="st">"Cl (wt.%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse_99</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">df</span>, x <span class="op">=</span> <span class="va">MgO</span>, y <span class="op">=</span> <span class="va">Cl</span>, conf_level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 361 × 2</span></span>
<span><span class="co">#&gt;         x     y</span></span>
<span><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 -0.138 0.770</span></span>
<span><span class="co">#&gt;  2 -0.138 0.759</span></span>
<span><span class="co">#&gt;  3 -0.138 0.748</span></span>
<span><span class="co">#&gt;  4 -0.137 0.737</span></span>
<span><span class="co">#&gt;  5 -0.135 0.726</span></span>
<span><span class="co">#&gt;  6 -0.132 0.715</span></span>
<span><span class="co">#&gt;  7 -0.129 0.704</span></span>
<span><span class="co">#&gt;  8 -0.124 0.693</span></span>
<span><span class="co">#&gt;  9 -0.119 0.681</span></span>
<span><span class="co">#&gt; 10 -0.114 0.670</span></span>
<span><span class="co">#&gt; # ℹ 351 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">df</span>, x <span class="op">=</span> <span class="va">MgO</span>, y <span class="op">=</span> <span class="va">Cl</span>, conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">ellipse_90</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">df</span>, x <span class="op">=</span> <span class="va">MgO</span>, y <span class="op">=</span> <span class="va">Cl</span>, conf_level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse_99</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse_95</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse_90</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"green"</span>, size <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">MgO</span>, y <span class="op">=</span> <span class="va">Cl</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylim</span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>, <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"MgO (wt.%)"</span>, y <span class="op">=</span> <span class="st">"Cl (wt.%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">wrap_plots</span><span class="op">(</span><span class="va">plot1</span>, <span class="va">plot2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%"></p>
<div class="section level4">
<h4 id="grouping">Grouping<a class="anchor" aria-label="anchor" href="#grouping"></a>
</h4>
<p>For grouping bivariate data, the <code>.group_by</code> argument can be used if the data contains an unique grouping variable (<code>.group_by = NULL</code> by default). When a grouping variable is provided, the function will compute the ellipses separately for each level of the factor, allowing you to explore potential differences or patterns within subgroups of the data.</p>
<p>It’s important to note that the grouping variable should be appropriately coded as a factor before passing it to the <code>.group_by</code> argument. If the variable is currently stored as a character or numeric type, you may need to convert it to a factor using functions like <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor()</a></code> or <code><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">forcats::as_factor()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse_grp</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">MgO</span>, <span class="va">Cl</span>, <span class="va">glassType</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1,444 × 3</span></span>
<span><span class="co">#&gt;        x     y glassType</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;    </span></span>
<span><span class="co">#&gt;  1 0.568 0.676 1        </span></span>
<span><span class="co">#&gt;  2 0.568 0.669 1        </span></span>
<span><span class="co">#&gt;  3 0.569 0.662 1        </span></span>
<span><span class="co">#&gt;  4 0.570 0.655 1        </span></span>
<span><span class="co">#&gt;  5 0.572 0.648 1        </span></span>
<span><span class="co">#&gt;  6 0.574 0.641 1        </span></span>
<span><span class="co">#&gt;  7 0.577 0.634 1        </span></span>
<span><span class="co">#&gt;  8 0.580 0.627 1        </span></span>
<span><span class="co">#&gt;  9 0.584 0.620 1        </span></span>
<span><span class="co">#&gt; 10 0.589 0.613 1        </span></span>
<span><span class="co">#&gt; # ℹ 1,434 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot3</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">MgO</span>, y <span class="op">=</span> <span class="va">Cl</span>, colour <span class="op">=</span> <span class="va">glassType</span>, shape <span class="op">=</span> <span class="va">glassType</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse_grp</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, colour <span class="op">=</span> <span class="va">glassType</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylim</span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>, <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"MgO (wt.%)"</span>, y <span class="op">=</span> <span class="st">"Cl (wt.%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">wrap_plots</span><span class="op">(</span><span class="va">plot1</span>, <span class="va">plot3</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="100%"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rpca_scores</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">)</span><span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">pcaPP</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pcaPP/man/PCAproj.html" class="external-link">PCAproj</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"qn"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"scores"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>glassType <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu">pull</span><span class="op">(</span><span class="va">glassType</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>PC1 <span class="op">=</span> <span class="va">Comp.1</span>, PC2 <span class="op">=</span> <span class="va">Comp.2</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse_pca</span> <span class="op">&lt;-</span> <span class="va">rpca_scores</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span><span class="fu"><a href="reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">PC1</span>, <span class="va">PC2</span>, <span class="va">glassType</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot4</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rpca_scores</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="va">PC2</span>, colour <span class="op">=</span> <span class="va">glassType</span>, shape <span class="op">=</span> <span class="va">glassType</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse_pca</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, colour <span class="op">=</span> <span class="va">glassType</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"PC1"</span>, y <span class="op">=</span> <span class="st">"PC2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot4</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-17-1.png" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="confidence-ellipsoid">Confidence Ellipsoid<a class="anchor" aria-label="anchor" href="#confidence-ellipsoid"></a>
</h3>
<p>The <code>confidence_ellipsoid</code> function accepts an additional variable <code>z</code> and computes the ellipsoid for trivariate data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipsoid_grp</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">confidence_ellipsoid</span><span class="op">(</span><span class="va">SiO2</span>, <span class="va">Na2O</span>, <span class="va">Fe2O3</span>, <span class="va">glassType</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10,000 × 4</span></span>
<span><span class="co">#&gt;        x     y     z glassType</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;    </span></span>
<span><span class="co">#&gt;  1  67.3  14.5 0.597 1        </span></span>
<span><span class="co">#&gt;  2  67.3  14.5 0.597 1        </span></span>
<span><span class="co">#&gt;  3  67.3  14.5 0.597 1        </span></span>
<span><span class="co">#&gt;  4  67.3  14.5 0.597 1        </span></span>
<span><span class="co">#&gt;  5  67.3  14.5 0.597 1        </span></span>
<span><span class="co">#&gt;  6  67.3  14.5 0.597 1        </span></span>
<span><span class="co">#&gt;  7  67.3  14.5 0.597 1        </span></span>
<span><span class="co">#&gt;  8  67.3  14.5 0.597 1        </span></span>
<span><span class="co">#&gt;  9  67.3  14.5 0.597 1        </span></span>
<span><span class="co">#&gt; 10  67.3  14.5 0.597 1        </span></span>
<span><span class="co">#&gt; # ℹ 9,990 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot5</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">plot3D</span><span class="fu">::</span><span class="fu">scatter3D</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">SiO2</span>,</span>
<span>    y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Na2O</span>, </span>
<span>    z <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Fe2O3</span>,</span>
<span>    colvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">glassType</span><span class="op">)</span>,</span>
<span>    colkey <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    phi <span class="op">=</span> <span class="fl">20</span>, </span>
<span>    bty <span class="op">=</span> <span class="st">"g"</span>, </span>
<span>    pch <span class="op">=</span> <span class="fl">20</span>, </span>
<span>    cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"SiO2 (wt.%)"</span>, ylab <span class="op">=</span> <span class="st">"Na2O (wt.%)"</span>, zlab <span class="op">=</span> <span class="st">"Fe2O3 (wt.%)"</span>,</span>
<span>    ticktype <span class="op">=</span> <span class="st">"detailed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-19-1.png" width="100%"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ConfidenceEllipse</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Christian L. Goueguel <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ChristianGoueguel/ConfidenceEllipse/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/ChristianGoueguel/ConfidenceEllipse/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://opensource.org/licenses/MIT" class="external-link"><img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="License: MIT"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Christian L. Goueguel.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
