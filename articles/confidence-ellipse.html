<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Confidence Ellipse • ConfidenceEllipse</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Confidence Ellipse">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ConfidenceEllipse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/confidence-ellipse.html">Confidence Ellipse</a></li>
    <li><a class="dropdown-item" href="../articles/confidence-ellipsoid.html">Confidence Ellipsoid</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ChristianGoueguel/ConfidenceEllipse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Confidence Ellipse</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ChristianGoueguel/ConfidenceEllipse/blob/v1.1.0/vignettes/confidence-ellipse.Rmd" class="external-link"><code>vignettes/confidence-ellipse.Rmd</code></a></small>
      <div class="d-none name"><code>confidence-ellipse.Rmd</code></div>
    </div>

    
    
<p>Confidence ellipses are extension of the concept of a confidence
interval, which is used for a single variable. The ellipse is centered
at the point representing the sample mean values of the two variables.
Its size and shape are determined by the chosen confidence level (e.g.,
95%) and the covariance matrix.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://christiangoueguel.github.io/ConfidenceEllipse/">ConfidenceEllipse</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">glass</span>, package <span class="op">=</span> <span class="st">"ConfidenceEllipse"</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="coordinate-points">Coordinate points<a class="anchor" aria-label="anchor" href="#coordinate-points"></a>
</h2>
<p>The <code>confidence_ellipse</code> function is used to compute the
coordinate points of the confidence ellipse and then the ellipse is
plotted on a two-dimensional plot <code>x</code> and <code>y</code> of
the data. Points that lie within the ellipse are considered to be part
of the underlying distribution with the specified confidence level
<code>conf_level</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse99</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">glass</span>, x <span class="op">=</span> <span class="va">SiO2</span>, y <span class="op">=</span> <span class="va">Al2O3</span>, conf_level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span><span class="va">ellipse95</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">glass</span>, x <span class="op">=</span> <span class="va">SiO2</span>, y <span class="op">=</span> <span class="va">Al2O3</span>, conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">ellipse90</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">glass</span>, x <span class="op">=</span> <span class="va">SiO2</span>, y <span class="op">=</span> <span class="va">Al2O3</span>, conf_level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse99_rob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">glass</span>, x <span class="op">=</span> <span class="va">SiO2</span>, y <span class="op">=</span> <span class="va">Al2O3</span>, conf_level <span class="op">=</span> <span class="fl">0.99</span>, robust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ellipse95_rob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">glass</span>, x <span class="op">=</span> <span class="va">SiO2</span>, y <span class="op">=</span> <span class="va">Al2O3</span>, conf_level <span class="op">=</span> <span class="fl">0.95</span>, robust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ellipse90_rob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">glass</span>, x <span class="op">=</span> <span class="va">SiO2</span>, y <span class="op">=</span> <span class="va">Al2O3</span>, conf_level <span class="op">=</span> <span class="fl">0.90</span>, robust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse99</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 361</span></span>
<span><span class="co">#&gt; Columns: 2</span></span>
<span><span class="co">#&gt; $ x <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 54.39806<span style="color: #949494;">, </span>54.39735<span style="color: #949494;">, </span>54.40034<span style="color: #949494;">, </span>54.40703<span style="color: #949494;">, </span>54.41742<span style="color: #949494;">, </span>54.43149<span style="color: #949494;">, </span>54.44926…</span></span>
<span><span class="co">#&gt; $ y <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.798453<span style="color: #949494;">, </span>2.771520<span style="color: #949494;">, </span>2.744243<span style="color: #949494;">, </span>2.716628<span style="color: #949494;">, </span>2.688685<span style="color: #949494;">, </span>2.660423<span style="color: #949494;">, </span>2.631849…</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse99</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">0.7</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse95</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">0.7</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse90</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"green"</span>, linewidth <span class="op">=</span> <span class="fl">0.7</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse99_rob</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1L</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse95_rob</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">1L</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse90_rob</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"green"</span>, linewidth <span class="op">=</span> <span class="fl">1L</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">glass</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SiO2</span>, y <span class="op">=</span> <span class="va">Al2O3</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"grey"</span>, color <span class="op">=</span> <span class="st">"black"</span>, shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">70</span>, y <span class="op">=</span> <span class="fl">3.5</span>, label <span class="op">=</span> <span class="st">"Classical confidence ellipses"</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">74</span>, y <span class="op">=</span> <span class="fl">2.3</span>, label <span class="op">=</span> <span class="st">"Robust confidence ellipses"</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">80</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"SiO2 (wt.%)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Al2O3 (wt.%)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Confidence ellipses"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">    Figure 1: Comparison between classical and robust confidence ellipse."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    aspect.ratio <span class="op">=</span> <span class="fl">.7</span>,</span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="confidence-ellipse_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="group-based-confidence-ellipses">Group-based confidence ellipses<a class="anchor" aria-label="anchor" href="#group-based-confidence-ellipses"></a>
</h2>
<p>For grouping bivariate data, the <code>.group_by</code> argument can
be used if the data contains an unique grouping variable
(<code>.group_by = NULL</code> by default). When a grouping variable is
provided, the function will compute the ellipses separately for each
level of the factor. It’s important to note that the grouping variable
should be appropriately coded as a factor before passing it to the
<code>.group_by</code> argument. If the variable is currently stored as
a character or numeric type, you may need to convert it to a factor
using functions like <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor()</a></code> or
<code><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">forcats::as_factor()</a></code>.</p>
<p>The function includes a <code>distribution</code> argument that
allows users to choose between two statistical approaches for ellipse
calculation:</p>
<ul>
<li>“normal” (default): Uses the chi-square distribution quantile</li>
<li>“hotelling”: Uses Hotelling’s T² distribution quantile</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse_grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">glass</span>, x <span class="op">=</span> <span class="va">SiO2</span>, y <span class="op">=</span> <span class="va">Na2O</span>, .group_by <span class="op">=</span> <span class="va">glassType</span><span class="op">)</span></span>
<span><span class="va">ellipse_grph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">glass</span>, x <span class="op">=</span> <span class="va">SiO2</span>, y <span class="op">=</span> <span class="va">Na2O</span>, .group_by <span class="op">=</span> <span class="va">glassType</span>, distribution <span class="op">=</span> <span class="st">"hotelling"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse_grp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,444 × 3</span></span></span>
<span><span class="co">#&gt;        x     y glassType</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  59.6  14.7 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  59.6  14.7 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  59.6  14.6 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  59.6  14.5 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  59.6  14.5 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  59.6  14.4 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  59.6  14.3 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  59.6  14.3 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  59.7  14.2 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  59.7  14.1 1        </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,434 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse_grph</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,444 × 3</span></span></span>
<span><span class="co">#&gt;        x     y glassType</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  59.5  14.7 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  59.5  14.7 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  59.5  14.6 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  59.5  14.5 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  59.5  14.5 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  59.5  14.4 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  59.5  14.3 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  59.5  14.3 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  59.6  14.2 1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  59.6  14.1 1        </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,434 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse_grp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">glassType</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">.45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">glass</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SiO2</span>, y <span class="op">=</span> <span class="va">Na2O</span>, color <span class="op">=</span> <span class="va">glassType</span>, shape <span class="op">=</span> <span class="va">glassType</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"SiO2 (wt.%)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Na2O (wt.%)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse_grph</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">glassType</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">.45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">glass</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SiO2</span>, y <span class="op">=</span> <span class="va">Na2O</span>, color <span class="op">=</span> <span class="va">glassType</span>, shape <span class="op">=</span> <span class="va">glassType</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"SiO2 (wt.%)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Na2O (wt.%)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">    Figure 2: Comparison between normal distribution (left) and Hotelling's T² distribution (right) ellipses."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Statistically-based confidence ellipses drawn around each group"</span>,</span>
<span>    theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="confidence-ellipse_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>As shown in the comparative plots, the difference between these
approaches can be substantial, especially for smaller sample sizes. The
Hotelling’s T² ellipses provide more realistic confidence regions that
properly account for the fact that we’re estimating population
parameters from sample data. As the sample size increases the
differences between both approaches diminish.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christian L. Goueguel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
